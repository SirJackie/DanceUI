<!DOCTYPE html>
<html>
    <head>
        <title>c</title>
        <link href="DanceUI.css" rel="stylesheet" type="text/css">
        <!-- <script src="DanceUI.js"></script> -->
    </head>
    <body>
        <line>
            <dance>1x</dance>
            <dance>1x</dance>
            <dance>1x</dance>
            <dance>1x</dance>
        </line>

        <line>
            <dance>1x</dance>
            <dance>1x</dance>
            <dance>1x</dance>
        </line>

        <line>
            <dance>1x</dance>
            <dance>1x</dance>
        </line>

        <line>
            <dance>1x</dance>
        </line>

        <line>
            <dance>
                <line>
                    <dance>1x</dance>
                    <dance>1x</dance>
                </line>

                <line>
                    <dance>1x</dance>
                </line>
            </dance>
        </line>

        <line>
            <dance width="4f">4x</dance>
            <dance width="3f">3x</dance>
            <dance width="2f">2x</dance>
            <dance width="1f">1x</dance>
        </line>

        <line>
            <dance width="3f">3x</dance>
            <dance width="2f">2x</dance>
            <dance width="1f">1x</dance>
        </line>

        <line>
            <dance width="2f">2x</dance>
            <dance width="1f">1x</dance>
        </line>

        <line>
            <dance>1x</dance>
        </line>

        <line>
            <dance>
                <line>
                    <dance width="3f">3x</dance>
                    <dance width="1f">1x</dance>
                </line>

                <line>
                    <dance width="2f">2x</dance>
                    <dance width="1f">1x</dance>
                </line>
            </dance>
        </line>
        <script>
            var DanceUI = {
                standardHeight : null,

                GetStandardHeight : function(){
                    DanceUI.standardHeight = document.documentElement.clientHeight / 15;
                },

                DecodeStringUnit : function(str){
                    var resultStr = str.match(/\d+f/);
                    if(resultStr == null){
                        resultStr = str.match(/\d+h/);
                        if(resultStr == null){
                            //出错
                            console.log("DanceUI Error:Cannot get string's unit");
                            console.log("Error String:");
                            console.log(str);
                            return null;
                        }
                        //单位是h
                        return ({
                            num : Math.floor(resultStr[0].substr(0,resultStr[0].length-1)),
                            unit : "h"
                        });
                    }
                    //单位是f
                    return ({
                        num : Math.floor(resultStr[0].substr(0,resultStr[0].length-1)),
                        unit : "f"
                    });
                },

                GetDanceArea : function(dance){
                    /* 定义areaObj */
                    var areaObj = {
                        width  : null,
                        height : null
                    }

                    /* 获取<dance>标签的宽高属性值 */
                    var danceWidthStr  = dance.getAttribute("width");
                    var danceHeightStr = dance.getAttribute("height");

                    /* 如果<dance>有宽,就获取,否则宽等于1f */
                    if(danceWidthStr == null){
                        areaObj.width = {
                            num  : 1,
                            unit : "f"
                        };
                    }
                    else{
                        areaObj.width = DanceUI.DecodeStringUnit(danceWidthStr);
                    }

                    /* 如果<dance>有高,就获取,否则高等于1h */
                    if(danceHeightStr == null){
                        areaObj.height = {
                            num  : 1,
                            unit : "h"
                        };
                    }
                    else{
                        areaObj.height = DanceUI.DecodeStringUnit(danceHeightStr);
                    }

                    /* 返回areaObj */
                    return areaObj;
                },

                calcDanceUseH : function(danceTag){
                    ;
                },

                refresh : function(parent){
                    /* 如果父节点是<line>,就开始布局自适应的<dance> */
                    if(parent.tagName == "LINE"){
                        for(var i = 0; i < parent.childNodes.length; i++){
                            // /* 获取或赋予并获取每个<dance>的宽高 */
                            

                            // /* 处理宽度 */
                            // var danceWidthF = f2num(danceWidthStr);
                            // console.log(danceWidthF);
                        }
                    }
                    /* 如果父节点不是<line>,或者处理完<line>了,就继续遍历子节点 */
                    for(var i = 0; i < parent.childNodes.length; i++){
                        DanceUI.refresh(parent.childNodes[i]);
                    }
                },

                UserWindowOnload : function(){
                    ;
                },

                UserWindowOnresize : function(){
                    ;
                },

                WindowOnload : function(){
                    DanceUI.GetStandardHeight();
                    DanceUI.refresh(document.getElementsByTagName("body")[0]);
                    DanceUI.UserWindowOnload();
                },

                WindowOnresize : function(){
                    DanceUI.refresh(document.getElementsByTagName("body")[0]);
                    DanceUI.UserWindowOnresize();
                }
            }
            

            window.onload = function(){
                DanceUI.WindowOnload();
            }
            window.onresize = function(){
                DanceUI.WindowOnresize();
            }
        </script>
    </body>
</html>