<!DOCTYPE html>
<html>
    <head>
        <title>c</title>
        <link href="DanceUI.css" rel="stylesheet" type="text/css">
        <!-- <script src="DanceUI.js"></script> -->
    </head>
    <body>
        <line>
            <dance>1x</dance>
            <dance>1x</dance>
            <dance>1x</dance>
            <dance>1x</dance>
        </line>

        <line>
            <dance>1x</dance>
            <dance>1x</dance>
            <dance>1x</dance>
        </line>

        <line>
            <dance>1x</dance>
            <dance>1x</dance>
        </line>

        <line>
            <dance>1x</dance>
        </line>

        <line>
            <dance>
                <line>
                    <dance>1x</dance>
                    <dance>1x</dance>
                </line>

                <line>
                    <dance>1x</dance>
                </line>
            </dance>
        </line>

        <line>
            <dance width="4f">4x</dance>
            <dance width="3f">3x</dance>
            <dance width="2f">2x</dance>
            <dance width="1f">1x</dance>
        </line>

        <line>
            <dance width="3f">3x</dance>
            <dance width="2f">2x</dance>
            <dance width="1f">1x</dance>
        </line>

        <line>
            <dance width="2f">2x</dance>
            <dance width="1f">1x</dance>
        </line>

        <line>
            <dance>1x</dance>
        </line>

        <line>
            <dance>
                <line>
                    <dance width="3f">3x</dance>
                    <dance width="1f">1x</dance>
                </line>

                <line>
                    <dance width="2f">2x</dance>
                    <dance width="1f">1x</dance>
                </line>
            </dance>
        </line>
        <script>
            function f2num(str){
                var resultStr = str.match(/\d+f/)[0];
                return Math.floor(resultStr.substr(0,resultStr.length-1));
            }

            function refresh(parent){
                /* 如果父节点不是<line>,就直接遍历子节点,不作处理 */
                if(parent.tagName != "LINE"){
                    for(var i = 0; i < parent.childNodes.length; i++){
                        refresh(parent.childNodes[i]);
                    }
                    return;
                }

                /* 如果父节点是<line>,就开始布局自适应的<dance> */
                for(var i = 0; i < parent.childNodes.length; i++){
                    console.log(parent.childNodes[i]);
                    // /* 获取或赋予并获取每个<dance>的宽高 */
                    // var danceWidthStr  = parent.childNodes[i].getAttribute("width");
                    // var danceHeightStr = parent.childNodes[i].getAttribute("height");
                    // if(danceWidthStr == null){
                    //     parent.childNodes[i].setAttribute("width", "1f");
                    //     danceWidthStr = "1f";
                    // }
                    // if(danceHeightStr == null){
                    //     parent.childNodes[i].setAttribute("height", "1h");
                    //     danceHeightStr = "1h";
                    // }

                    // /* 处理宽度 */
                    // var danceWidthF = f2num(danceWidthStr);
                    // console.log(danceWidthF);
                }

                /* 处理完这个<line>了,继续遍历子节点 */
                for(var i = 0; i < parent.childNodes.length; i++){
                    refresh(parent.childNodes[i]);
                }
            }

            refresh(document.getElementsByTagName("body")[0]);

            // var dance = document.getElementsByTagName("dance");
            // var i = 0;
            // var danceHeightStr = dance[i].getAttribute("height");
            // console.log(danceHeightStr);

            // var danceHeightF = f2num(danceHeightStr);
            // console.log(danceHeightF);
        </script>
    </body>
</html>